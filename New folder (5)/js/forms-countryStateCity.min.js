$(document).ready(function () {

    var cityhtml = $('select#city').html();
    var statehtml = $('select#state').html();
    var dealerCity = $("#dealerCity").attr("data-dealerCity");
    var countryDefaultCode = $(".toursState").attr("data-country-code");

    $('select#country').change(function () {
        var countryid = $('select#country option:selected').val();
        $('select#state').html(statehtml);
        $('select#city').html(cityhtml);
        if (countryid) {
        $.ajax({
            type: "GET",
            url: $(this).attr('data-csc-api') + "?countryCode=" + $('option:selected', $(this)).val(),
            dataType: "json",
            success: function (data) {
                $('select#state').html(statehtml);
                $('select#city').html(cityhtml);
                if (Object.keys(data).length !== 0) {
                    $('#state').parent().removeClass("d-none");
                    $('#city').parent().removeClass("d-none");
                    for (var key in data) {
                        var htmlString = "<option value=" + key + ">" + data[key] + "</option>";
                        $(htmlString).appendTo('select#state');
                    }
                } else if(Object.keys(data).length === 0){
                    $('#state').parent().addClass("d-none");
                    $('#city').parent().addClass("d-none");
                 }
            
            }
        });

        $('#country-hidden').val($('option:selected', $(this)).text());
        $('#state-hidden').val('');
        $('select#state').val('');
        $('#city-hidden').val('');
        $('select#city').val('');
    }
    });

    

    $('select#state').change(function () {
        var countryCode = $('select#country').val();
        if (typeof countryCode == "undefined")
            countryCode = countryDefaultCode;
        var stateid = $('select#state option:selected').val();
        $('select#city').html(cityhtml);
        if (stateid) {
            $.ajax({
                type: "GET",
                url: $(this).attr('data-csc-api') + "?countryCode=" + countryCode + "&stateCode=" + $('option:selected', $(this)).val(),
                dataType: "json",
                success: function (data) {
                    
                    for (var key in data) {
                        var htmlString = "<option value=" + key + ">" + data[key] + "</option>";
                        $(htmlString).appendTo('select#city');
                    }
                }
            });

            $('#state-hidden').val($('option:selected', $(this)).text());
        }
    });

    $('select#city').change(function () {
        $('#city-hidden').val($('option:selected', $(this)).text());
    });

    var cityArr = [];
    var inputCSC = document.getElementById("citySuggestion");
      if(inputCSC!= null && inputCSC!= undefined && inputCSC.length>0){
    var awesompleteCSC = new Awesomplete(inputCSC, {
        minChars: 3, 
        autoFirst: true,
        maxItems: 500
    });}
    $(".visually-hidden").hide();
    if($("#citySuggestion").attr("city-suggestionbox") == "true"){
    $("#citySuggestion").on("input", function () {
        let cityValueData = $(this).val();
        var CArr = "";
        var passwAl = /^[-'a-zA-Z ]+$/;
        if ((!passwAl.test(cityValueData) && cityValueData != "")|| cityValueData == "") {
            var cityValueDatastr = cityValueData.substring(0, cityValueData.length - 1);
            $("#citySuggestion").val(cityValueDatastr);
        }
        if (cityValueData.length > 3) {
            cityArr = [];
            $.ajax({
                url: dealerCity +"?city=" + cityValueData + "&country=" + $('select#country').val(),
                type: "GET",
                success: function(res) {
                    if(res.code == 200){
                        cityArr.push(res.data);
                        CArr= res.data;
                        awesompleteCSC.list = CArr;
                    }else if(res.code == 404){
                        showDialog($("#citySuggestion").attr("invaild-data"));
                       $("#citySuggestion").val("");
                       $("#citySuggestion").blur();
                    }
                },
                error: function(error) {
                }
            });
        }else{
            CArr = [];
            awesompleteCSC.list = CArr;
        }
    });

     $("#citySuggestion").blur(function(){
        var inputVaue = $(this).val();
        if(cityArr[0].includes(inputVaue) && inputVaue != ""){
        }else if(inputVaue != ""){
            showDialog($("#citySuggestion").attr("invaild-data"));
            $("#citySuggestion").val("");
        }
    });
}
});
$(document).ready(function () {
    if ($(window).width() <= 767) {
        $(".col-item").each(function () {
            $(this).removeClass("col");
            $(this).addClass("col-sm-12");
        });
    }

    $(window).resize(function () {
        if ($(window).width() <= 767) {
            $(".col-item").each(function () {
                $(this).removeClass("col");
                $(this).addClass("col-sm-12");
            });
        } else {
            $(".col-item").each(function () {
                $(this).removeClass("col-sm-12");
                $(this).addClass("col");
            });
        }
    });
});
$(document).ready(function () {

  $(document).on("change",".formElementsCountryAna",function(){
  let dataPlaceholder = $(this).attr("data-placehoder");
  let dataval = $(this).find("option:selected").text().trim();

  if(dataval){
    dataLayer.push({
      'event':'countryState',
      'eventCategory':'countryState',
      'eventAction':dataPlaceholder,
      'eventLabel':dataval
  })
  }
  });
});

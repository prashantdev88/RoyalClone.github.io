//carousel slider [START]
$(document).ready(function () {


//carousel slider [END]
var previousBannerName = $(".slick-list").children().children(".slick-active").children("div").children().children().children(".banner-inner-img").children("picture").children("img").attr("alt");
$(document).on('click','.craouselsliderAna .slick-prev, .craouselsliderAna .slick-next',function(){
    let currentBannerName = $(this).siblings(".slick-list").children().children(".slick-active").children("div").children().children().children(".banner-inner-img").children("picture").children("img").attr("alt");
    let ctaText = $(this).text().trim();
    dataLayer.push({
        'event':'carousel',
        'eventCategory':'carousel',
        'eventAction': currentBannerName,
        'eventLabel':"",
        'previousBannerName':previousBannerName,
        'arrowClicked':ctaText
    });
    previousBannerName = currentBannerName;
});

$(document).on('click','.craouselsliderAna .slick-dots li button',function(){
    let currentBannerName = $(this).parent("li").parent("ul").siblings(".slick-list").children().children(".slick-active").children("div").children().children().children(".banner-inner-img").children("picture").children("img").attr("alt");
    let ctaText = $(this).text().trim();
    dataLayer.push({
        'event':'carousel',
        'eventCategory':'carousel',
        'eventAction': currentBannerName,
        'eventLabel':"",
        'previousBannerName':previousBannerName,
        'arrowClicked':"dots"
    });
    previousBannerName = currentBannerName;
});

$('.carousel-slider').slick({
		slidesToShow: 1,
		slidesToScroll: 1,
		fade: false,
		infinite: true,
		speed: 1000,
	  	touchThreshold: 15,
		responsive: [
		{
		breakpoint: 520,
		settings: {
	        slidesToShow: 1,
	        slidesToScroll: 1,
  			arrows: false
			}
		}
		// You can unslick at a given breakpoint now by adding:
		// settings: "unslick"
		// instead of a settings object
		]
	});
// Divesh Kanojia
    //ticking machine
var percentTime;
var tick;
let timeArr = [];
$(".progressBar").each(function () {
  timeArr.push(parseInt($(this).attr("data-slick-time")) / 1000);
});
console.log(timeArr);
var progressBarIndex = 0;
var time = timeArr[progressBarIndex];

$(".progressBarContainer .progressBar").each(function (index) {
  var progress = "<div class='inProgress inProgress" + index + "'></div>";
  $(this).html(progress);
});

function startProgressbar() {
  resetProgressbar();
  percentTime = 0;
  console.log(progressBarIndex);
  time = timeArr[progressBarIndex];
  console.log(time);
  tick = setInterval(interval, 100);
}

function interval() {
  if (
    $(
      '.slider .slick-track div[data-slick-index="' + progressBarIndex + '"]'
    ).attr("aria-hidden") === "true"
  ) {
    progressBarIndex = $('.slider .slick-track div[aria-hidden="false"]').data(
      "slickIndex"
    );
    startProgressbar();
  } else {
    percentTime += 1 / (time);
    $(".inProgress" + progressBarIndex).css({
      width: percentTime + "%",
    });
    if (percentTime >= 100) {
      $(".carousel-slider").slick("slickNext");
      progressBarIndex++;
      if (progressBarIndex > 2) {
        progressBarIndex = 0;
      }
      startProgressbar();
    }
  }
  return progressBarIndex;
}

function resetProgressbar() {
  $(".inProgress").css({
    width: 0 + "%",
  });
  clearInterval(tick);
}
startProgressbar();
// End ticking machine

$(".item").click(function () {
  clearInterval(tick);
  var goToThisIndex = $(this).find("span").data("slickIndex");
  $(".carousel-slider").slick("slickGoTo", goToThisIndex, false);
  startProgressbar();
});

});
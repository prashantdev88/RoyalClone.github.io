
var windowSize = $(window).width();
 if(windowSize < 767){

$('.pro-carousel').slick({
		slidesToShow: 1,
		slidesToScroll: 1,
		arrows: false,
		fade: false,
		infinite: false,
		speed: 1000,
		dots:true,
	  	swipe: true,
});
} 


$('.thumb-slider').slick({
		slidesToShow: 3,
		slidesToScroll: 3,
		arrows: true,
		fade: false,
		infinite: false,
		speed: 1000,
		dots:true,
	  	swipe: true,
	  	responsive: [
		{
		breakpoint: 800,
		settings: {
	        slidesToShow: 2,
	        slidesToScroll: 2,
			}
		},
		{
		breakpoint: 480,
		settings: {
	        slidesToShow: 1,
	        slidesToScroll: 1,
			}
		}
	]
});

$(document).ready(function(){

    function prResize(){
        var profileHeight = $(".profile-lh .profile-image").width();
        $(".profile-lh .profile-image").css("height", profileHeight+"px");
    }

    prResize();

    $(window).resize(function() {
        prResize();
    });
});

$(document).ready(function () {
    setTimeout(fetchuserData, 1500);

    // Split tags URL
    var pth = document.getElementsByClassName("hashtag");
    if (pth) {
        Array.prototype.forEach.call(pth, function (item) {
            var activePath = item.getAttribute("href");
            var newUrl = activePath.split("#", 2);
            activePath = newUrl[0] + newUrl[1];
            item.setAttribute("href", activePath);
        });
    }
    var aboutMeText;
    //console.log($('#profPic').attr('data-attr-profile'));

    if (aboutMeText) {
        var aboutMeTextArr = aboutMeText.split(" ");
        if (aboutMeTextArr.length > 5) {
            $('.read-more').html('Read more....');
            var lessText = aboutMeTextArr[0] + " " + aboutMeTextArr[1] + " " + aboutMeTextArr[2] + " " + aboutMeTextArr[3] + " " + aboutMeTextArr[4] + " ";
            $('.about-me-text').html(lessText);
        } else {
            $('.about-me-text').html(aboutMeText);
        }
    } else {
        $('.about-me-text').html($('.about-me-text').attr("default-text"))
    }
    $('.read-more').click(function () {
        $('.read-more').html("");
        $('.about-me-text').html("");
        $('.about-me-text').html(aboutMeText);
        return false;
    });

    // $('.hashTagSearch').click(function () {

    //     var url = $(this).attr('data-attr-url');
    //     var search = $(this).attr('data-attr-search');
    //     var query = search.split('#')[1];

    //     window.location.assign(url + "?socialTag=" + query);


    // });

     $(document).on( "click", ".hashtag", function() {
  
        var url = $(this).attr('data-attr-url');

        var replaceText = "/content";
        if(url.indexOf(replaceText) != -1){
         url = url.replace("/content/royal-enfield" , "");
        }
        var search = $(this).attr('data-attr-search');
        var query = search.split('#')[1];

        window.location.assign(url + "?socialTag=" + query);

});

    $('.mybox').click(function () {
        $('.mybox').removeClass('active');
        $(this).addClass('active')
    })
});
function fetchuserData(){
    collectionData.doc('userInfo')
    .onSnapshot(function (doc) {
        let realtimeChange = {};
        realtimeChange = doc.data();
        aboutMeText = realtimeChange.aboutMe;
        if (aboutMeText) {
            var aboutMeTextArr = aboutMeText.split(" ");
            if (aboutMeTextArr.length > 5) {
                $('.read-more').html('Read more....');
                var lessText = aboutMeTextArr[0] + " " + aboutMeTextArr[1] + " " + aboutMeTextArr[2] + " " + aboutMeTextArr[3] + " " + aboutMeTextArr[4] + " ";
                $('.about-me-text').html(lessText);
            } else {
                $('.about-me-text').html(aboutMeText);
            }
        } else {
            $('.about-me-text').html($('.about-me-text').attr("default-text"))
        }
        $(".motorcycleLogInHeading").remove();
        $('#profPic').attr('src',realtimeChange.profileUrl);
        $('#coverImage').attr('src',realtimeChange.coverImage);
        $('#userName').html(realtimeChange.fName + " " +realtimeChange.lName);
        let motorCycleOwnedData = realtimeChange.motorcyclesOwned;
        if(motorCycleOwnedData){
        for(var i=0; i< motorCycleOwnedData.length; i++){
            $("<div class='motorcycleLogInHeading'><p>"+motorCycleOwnedData[i].bikeName+"</p></div>").insertAfter("#motorcycleOwnedHeading");
        }
        }else{
            $('#defaultText').show();
        }
        let userTagData = realtimeChange.listofTags;
        let myTagDefaultUrl = $(".my-tags-holder").attr("data-attr-url");
        if(userTagData){
        $(".hashtag").remove();
        for(var j=0; j< userTagData.length; j++){
          //  $('<a href="javascript:void(0);" class="custom-btn bor clr-b hashtag" data-attr-url="'+myTagDefaultUrl+'" data-attr-search="'+userTagData[j].userTags+'">'+userTagData[j].userTags+'</a>').insertAfter(".my-tags-holder");
        $(".my-tags-holder").append($('<a href="javascript:void(0);" class="custom-btn bor clr-b hashtag" data-attr-url="'+myTagDefaultUrl+'" data-attr-search="'+userTagData[j].userTags+'">'+userTagData[j].userTags+'</a>'));
        }
    }
        console.log("Online", realtimeChange);
        var source = doc.metadata.fromCache ? "local cache" : "server";
        console.log("Data came from " + source);
    })
}
$(function(){
$(document).on('click','.userLoggedInAna',function(){
    let ctaText;
    let nextPageURL = $(this).attr("href");
    if(nextPageURL == undefined || nextPageURL == "javascript:"){
        nextPageURL = "";
    }
    if($(this).hasClass("cta_nv")){
        ctaText = $(this).children("p").text().trim();
    }else if($(this).hasClass("pro-cta")){
        ctaText = $(this).children(".card-comp").children("img").attr("alt");
    }else{
        ctaText = $(this).text().trim();
    }
    dataLayer.push({
        'event':'userProfileLoggedIn',
        'eventCategory':'userProfileLoggedIn',
        'eventAction':ctaText,
        'eventLabel':nextPageURL
    });
});
});
